<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>CV & Motivation Letter Generator</title>
        <script src="https://cdn.tailwindcss.com"></script>
    </head>
    <body class="bg-gray-50 min-h-screen">
        <div class="container mx-auto px-4 py-8 max-w-6xl">
            <header class="text-center mb-12">
                <h1 class="text-3xl font-bold text-gray-800 mb-2">
                    CV & Motivation Letter Generator
                </h1>
                <p class="text-gray-600">
                    Generate professional CVs and motivation letters using local
                    Ollama models
                </p>
            </header>

            <main class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Input Section -->
                <section class="bg-white rounded-lg shadow-md p-6">
                    <h2 class="text-xl font-semibold text-gray-800 mb-4">
                        Input Details
                    </h2>

                    <div class="mb-6">
                        <label
                            for="personalDetails"
                            class="block text-sm font-medium text-gray-700 mb-2"
                        >
                            Personal Details (Education, Experience, Skills,
                            etc.)
                        </label>
                        <textarea
                            id="personalDetails"
                            rows="10"
                            class="w-full px-3 py-2 text-gray-700 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                            placeholder="Enter your personal details including education, work experience, skills, achievements, etc."
                        ></textarea>
                    </div>

                    <div class="mb-6">
                        <label
                            for="jobDetails"
                            class="block text-sm font-medium text-gray-700 mb-2"
                        >
                            Job Details (Description, Requirements, etc.)
                        </label>
                        <textarea
                            id="jobDetails"
                            rows="8"
                            class="w-full px-3 py-2 text-gray-700 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                            placeholder="Enter the job description, requirements, and any other relevant details about the position"
                        ></textarea>
                    </div>

                    <div class="mb-6">
                        <label
                            for="modelSelect"
                            class="block text-sm font-medium text-gray-700 mb-2"
                        >
                            Select Ollama Model
                        </label>
                        <select
                            id="modelSelect"
                            class="w-full px-3 py-2 text-gray-700 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                        >
                            <option value="llama3">Llama 3</option>
                            <option value="mistral">Mistral</option>
                            <option value="gemma">Gemma</option>
                            <option value="phi3">Phi-3</option>
                        </select>
                    </div>

                    <div class="flex flex-wrap gap-4">
                        <button
                            id="generateCV"
                            class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors"
                        >
                            Generate CV
                        </button>
                        <button
                            id="generateMotivation"
                            class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors"
                        >
                            Generate Motivation Letter
                        </button>
                        <button
                            id="generateBoth"
                            class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition-colors"
                        >
                            Generate Both
                        </button>
                    </div>

                    <div
                        id="loadingIndicator"
                        class="hidden mt-4 flex items-center text-blue-600"
                    >
                        <svg
                            class="animate-spin -ml-1 mr-2 h-5 w-5 text-blue-600"
                            xmlns="http://www.w3.org/2000/svg"
                            fill="none"
                            viewBox="0 0 24 24"
                        >
                            <circle
                                class="opacity-25"
                                cx="12"
                                cy="12"
                                r="10"
                                stroke="currentColor"
                                stroke-width="4"
                            ></circle>
                            <path
                                class="opacity-75"
                                fill="currentColor"
                                d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
                            ></path>
                        </svg>
                        Generating, please wait...
                    </div>

                    <div
                        id="errorMessage"
                        class="hidden mt-4 p-3 bg-red-100 text-red-700 rounded-lg"
                    ></div>
                </section>

                <!-- Output Section -->
                <section class="space-y-8">
                    <!-- CV Output -->
                    <div
                        id="cvOutput"
                        class="bg-white rounded-lg shadow-md p-6 hidden"
                    >
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="text-xl font-semibold text-gray-800">
                                Generated CV
                            </h2>
                            <button
                                id="copyCV"
                                class="px-3 py-1 text-sm bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-colors"
                            >
                                Copy
                            </button>
                        </div>
                        <div
                            id="cvContent"
                            class="prose max-w-none text-gray-700 whitespace-pre-line"
                        ></div>
                    </div>

                    <!-- Motivation Letter Output -->
                    <div
                        id="motivationOutput"
                        class="bg-white rounded-lg shadow-md p-6 hidden"
                    >
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="text-xl font-semibold text-gray-800">
                                Generated Motivation Letter
                            </h2>
                            <button
                                id="copyMotivation"
                                class="px-3 py-1 text-sm bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-colors"
                            >
                                Copy
                            </button>
                        </div>
                        <div
                            id="motivationContent"
                            class="prose max-w-none text-gray-700 whitespace-pre-line"
                        ></div>
                    </div>
                </section>
            </main>
        </div>

        <script>
            // DOM Elements
            const personalDetailsInput =
                document.getElementById("personalDetails");
            const jobDetailsInput = document.getElementById("jobDetails");
            const modelSelect = document.getElementById("modelSelect");
            const generateCVBtn = document.getElementById("generateCV");
            const generateMotivationBtn =
                document.getElementById("generateMotivation");
            const generateBothBtn = document.getElementById("generateBoth");
            const loadingIndicator =
                document.getElementById("loadingIndicator");
            const errorMessage = document.getElementById("errorMessage");
            const cvOutput = document.getElementById("cvOutput");
            const motivationOutput =
                document.getElementById("motivationOutput");
            const cvContent = document.getElementById("cvContent");
            const motivationContent =
                document.getElementById("motivationContent");
            const copyCVBtn = document.getElementById("copyCV");
            const copyMotivationBtn = document.getElementById("copyMotivation");

            // Event Listeners
            generateCVBtn.addEventListener("click", () =>
                generateDocument("cv")
            );
            generateMotivationBtn.addEventListener("click", () =>
                generateDocument("motivation")
            );
            generateBothBtn.addEventListener("click", () =>
                generateDocument("both")
            );
            copyCVBtn.addEventListener("click", () =>
                copyToClipboard(cvContent.textContent)
            );
            copyMotivationBtn.addEventListener("click", () =>
                copyToClipboard(motivationContent.textContent)
            );

            // Functions
            async function generateDocument(type) {
                const personalDetails = personalDetailsInput.value.trim();
                const jobDetails = jobDetailsInput.value.trim();
                const model = modelSelect.value;

                if (!personalDetails || !jobDetails) {
                    showError(
                        "Please fill in both personal details and job details"
                    );
                    return;
                }

                showLoading(true);
                hideError();

                try {
                    if (type === "cv" || type === "both") {
                        const cvPrompt = constructCVPrompt(
                            personalDetails,
                            jobDetails
                        );
                        const cvResponse = await callOllamaAPI(cvPrompt, model);
                        displayCV(cvResponse);
                    }

                    if (type === "motivation" || type === "both") {
                        const motivationPrompt = constructMotivationPrompt(
                            personalDetails,
                            jobDetails
                        );
                        const motivationResponse = await callOllamaAPI(
                            motivationPrompt,
                            model
                        );
                        displayMotivationLetter(motivationResponse);
                    }
                } catch (error) {
                    showError(`Error: ${error.message}`);
                } finally {
                    showLoading(false);
                }
            }

            function constructCVPrompt(personalDetails, jobDetails) {
                return `You are a professional CV writer. Based on the following personal details and job description, create a professional, well-structured CV tailored to this specific job.

Personal Details:
${personalDetails}

Job Details:
${jobDetails}

Please create a CV that:
1. Highlights the most relevant skills and experiences for this job
2. Uses a professional format with clear sections
3. Is concise but comprehensive
4. Focuses on achievements rather than just responsibilities
5. Uses action verbs and quantifiable results where possible

Format the CV with appropriate sections such as:
- Contact Information
- Professional Summary
- Work Experience
- Education
- Skills
- Achievements
- Certifications (if applicable)

Return only the CV content without any additional explanations.`;
            }

            function constructMotivationPrompt(personalDetails, jobDetails) {
                return `You are a professional motivation letter writer. Based on the following personal details and job description, create a compelling motivation letter tailored to this specific job.

Personal Details:
${personalDetails}

Job Details:
${jobDetails}

Please create a motivation letter that:
1. Clearly expresses interest in the position
2. Demonstrates understanding of the company and role
3. Highlights relevant skills and experiences from the candidate's background
4. Explains why the candidate is a good fit for this specific role
5. Shows enthusiasm and professionalism
6. Follows a formal letter structure

Format the motivation letter with:
- Appropriate salutation
- Introduction stating the position of interest
- Body paragraphs highlighting relevant qualifications
- Conclusion expressing interest in further discussion
- Professional closing

Return only the motivation letter content without any additional explanations.`;
            }

            async function callOllamaAPI(prompt, model) {
                const response = await fetch(
                    "http://localhost:11434/api/generate",
                    {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                        },
                        body: JSON.stringify({
                            model: model,
                            prompt: prompt,
                            stream: false,
                        }),
                    }
                );

                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }

                const data = await response.json();
                return data.response;
            }

            function displayCV(content) {
                cvContent.textContent = content;
                cvOutput.classList.remove("hidden");
            }

            function displayMotivationLetter(content) {
                motivationContent.textContent = content;
                motivationOutput.classList.remove("hidden");
            }

            function showLoading(show) {
                if (show) {
                    loadingIndicator.classList.remove("hidden");
                } else {
                    loadingIndicator.classList.add("hidden");
                }
            }

            function showError(message) {
                errorMessage.textContent = message;
                errorMessage.classList.remove("hidden");
            }

            function hideError() {
                errorMessage.classList.add("hidden");
            }

            async function copyToClipboard(text) {
                try {
                    await navigator.clipboard.writeText(text);
                    // Show a temporary success message
                    const originalText = event.target.textContent;
                    event.target.textContent = "Copied!";
                    setTimeout(() => {
                        event.target.textContent = originalText;
                    }, 2000);
                } catch (err) {
                    console.error("Failed to copy: ", err);
                }
            }
        </script>
    </body>
</html>
